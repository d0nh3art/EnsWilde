//
//  ObfuscatedPaths.swift
//  EnsWilde
//
//  Central location for obfuscated system paths used throughout the app
//  These strings are hidden from the binary's __cstring section via SecureString
//

import Foundation

/// Collection of obfuscated system paths used throughout EnsWilde
/// All paths are decoded at runtime from byte arrays to prevent static analysis
enum ObfuscatedPaths {
    
    // MARK: - /var/mobile Paths
    
    /// Returns: "/var/mobile/"
    static var varMobile: String {
        SecureString.reveal([
            0x2F, 0x76, 0x61, 0x72, 0x2F, 0x6D, 0x6F, 0x62, 0x69, 0x6C, 0x65, 0x2F
        ])
    }
    
    /// Returns: "/private/var/mobile/"
    static var privateVarMobile: String {
        SecureString.reveal([
            0x2F, 0x70, 0x72, 0x69, 0x76, 0x61, 0x74, 0x65, 0x2F, 0x76, 0x61, 0x72, 0x2F,
            0x6D, 0x6F, 0x62, 0x69, 0x6C, 0x65, 0x2F
        ])
    }
    
    /// Returns: "/var/mobile/backup"
    static var varMobileBackup: String {
        SecureString.reveal([
            0x2F, 0x76, 0x61, 0x72, 0x2F, 0x6D, 0x6F, 0x62, 0x69, 0x6C, 0x65, 0x2F,
            0x62, 0x61, 0x63, 0x6B, 0x75, 0x70
        ])
    }
    
    /// Returns: "/private/var/mobile/backup"
    static var privateVarMobileBackup: String {
        SecureString.reveal([
            0x2F, 0x70, 0x72, 0x69, 0x76, 0x61, 0x74, 0x65, 0x2F, 0x76, 0x61, 0x72, 0x2F,
            0x6D, 0x6F, 0x62, 0x69, 0x6C, 0x65, 0x2F, 0x62, 0x61, 0x63, 0x6B, 0x75, 0x70
        ])
    }
    
    /// Returns: "/var/mobile/Media/"
    static var varMobileMedia: String {
        SecureString.reveal([
            0x2F, 0x76, 0x61, 0x72, 0x2F, 0x6D, 0x6F, 0x62, 0x69, 0x6C, 0x65, 0x2F,
            0x4D, 0x65, 0x64, 0x69, 0x61, 0x2F
        ])
    }
    
    // MARK: - Container Paths
    
    /// Returns: "/var/containers/Shared/SystemGroup/"
    static var systemGroupBase: String {
        SecureString.reveal([
            0x2F, 0x76, 0x61, 0x72, 0x2F, 0x63, 0x6F, 0x6E, 0x74, 0x61, 0x69, 0x6E, 0x65, 0x72, 0x73, 0x2F,
            0x53, 0x68, 0x61, 0x72, 0x65, 0x64, 0x2F, 0x53, 0x79, 0x73, 0x74, 0x65, 0x6D, 0x47, 0x72, 0x6F,
            0x75, 0x70, 0x2F
        ])
    }
    
    /// Returns: "/private/var/containers/Shared/SystemGroup/"
    static var privateSystemGroupBase: String {
        SecureString.reveal([
            0x2F, 0x70, 0x72, 0x69, 0x76, 0x61, 0x74, 0x65, 0x2F, 0x76, 0x61, 0x72, 0x2F, 0x63, 0x6F, 0x6E,
            0x74, 0x61, 0x69, 0x6E, 0x65, 0x72, 0x73, 0x2F, 0x53, 0x68, 0x61, 0x72, 0x65, 0x64, 0x2F, 0x53,
            0x79, 0x73, 0x74, 0x65, 0x6D, 0x47, 0x72, 0x6F, 0x75, 0x70, 0x2F
        ])
    }
    
    // MARK: - Library Paths
    
    /// Returns: "/var/mobile/Library/Passes/Cards/"
    static var walletCardsPath: String {
        SecureString.reveal([
            0x2F, 0x76, 0x61, 0x72, 0x2F, 0x6D, 0x6F, 0x62, 0x69, 0x6C, 0x65, 0x2F, 0x4C, 0x69, 0x62, 0x72,
            0x61, 0x72, 0x79, 0x2F, 0x50, 0x61, 0x73, 0x73, 0x65, 0x73, 0x2F, 0x43, 0x61, 0x72, 0x64, 0x73,
            0x2F
        ])
    }
    
    /// Returns: "/var/mobile/Library/Caches/"
    static var varMobileCaches: String {
        SecureString.reveal([
            0x2F, 0x76, 0x61, 0x72, 0x2F, 0x6D, 0x6F, 0x62, 0x69, 0x6C, 0x65, 0x2F, 0x4C, 0x69, 0x62, 0x72,
            0x61, 0x72, 0x79, 0x2F, 0x43, 0x61, 0x63, 0x68, 0x65, 0x73, 0x2F
        ])
    }
    
    // MARK: - Process Paths (for process matching)
    
    /// Returns: "/bookassetd"
    static var bookassetdProcess: String {
        SecureString.reveal([
            0x2F, 0x62, 0x6F, 0x6F, 0x6B, 0x61, 0x73, 0x73, 0x65, 0x74, 0x64
        ])
    }
    
    /// Returns: "/Books"
    static var booksProcess: String {
        SecureString.reveal([
            0x2F, 0x42, 0x6F, 0x6F, 0x6B, 0x73
        ])
    }
    
    /// Returns: "/itunesstored"
    static var itunesstored: String {
        SecureString.reveal([
            0x2F, 0x69, 0x74, 0x75, 0x6E, 0x65, 0x73, 0x73, 0x74, 0x6F, 0x72, 0x65, 0x64
        ])
    }
    
    /// Returns: "/backboardd"
    static var backboardd: String {
        SecureString.reveal([
            0x2F, 0x62, 0x61, 0x63, 0x6B, 0x62, 0x6F, 0x61, 0x72, 0x64, 0x64
        ])
    }
    
    // MARK: - Helper Methods
    
    /// Build a path by combining obfuscated base with unobfuscated suffix
    /// - Parameters:
    ///   - base: Obfuscated base path
    ///   - suffix: Plain suffix to append
    /// - Returns: Combined path
    static func combine(_ base: String, _ suffix: String) -> String {
        return base + suffix
    }
}
